{% extends 'base.html' %}
{% load thumbnail %}
{% block title %}
  Сотрудник
{% endblock title %}
{% block content %}
  <div class="row justify-content-center">
    <aside class="col col-lg-6">
      <div class="card-deck">
        <div class="card p-0" style="border-radius: 0;">
          {% thumbnail persona.image "960x600" crop="center" upscale=True as im %}
            <img class="card-img-top" src="{{ im.url }}" alt="Card image cap">
          {% endthumbnail %}
          <div class="card-body m-4">
            <h5 class="card-title">
              {{ persona.last_name }}
              {{ persona.first_name }}
              {{ persona.patronymic_name }}
            </h5>
            <p class="card-text">
              <strong>Должность:</strong> {{ persona.seat }}
              <br>
              {% if persona.academic is not None and persona.academic is not False %}
                <strong>Ученая степень:</strong> {{ persona.academic }}
                <br>
              {% endif %}
              <strong>Отделение:</strong>
              {% for depart in persona_departments %}
                <a
                  href="{% url 'structure:depart_detail' depart.department.id %}">
                {{ depart.department.title }}
                </a>
                {% if not forloop.last %}, {% endif %}
              {% endfor %}
              {% if persona.speciality is not None %}
                {{ persona.speciality }}
                <br>
              {% endif %}
            </p>
            {% if persona.biography %}
              <p class="card-text">{{ persona.biography }}</p>
            {% endif %}
            {% if persona.education %}
              <p class="card-text">
                <strong>Образование:</strong>
                {{ persona.education }}
              </p>
            {% endif %}
            {% if persona.qualification %}
              <p class="card-text">
                <strong>Квалификация:</strong>
                {{ persona.qualification }}
              </p>
            {% endif %}
            {% if persona.experience %}
              <p class="card-text">
                <strong>Опыт работы:</strong>
                {{ persona.experience }}</p>
            {% endif %}
            {% if adding_rate == True %}
              <p><strong>Рейтинг:</strong>
                {{ persona.avg_rating|floatformat:2 }}
              </p>
              <form method="POST">
                {% csrf_token %}
                <div class="rating">
                  <input type="hidden" name="score" id="score">
                  <i
                    class="fa fa-star {% if average_rating >= 1 %}checked{% else %}{% endif %}"
                    data-value="1"
                    id="first"></i>
                  <i
                    class="fa fa-star {% if average_rating >= 2 %}checked{% else %}{% endif %}"
                    data-value="2"
                    id="second"></i>
                  <i
                    class="fa fa-star {% if average_rating >= 3 %}checked{% else %}{% endif %}"
                    data-value="3"
                    id="third"></i>
                  <i
                    class="fa fa-star {% if average_rating >= 4 %}checked{% else %}{% endif %}"
                    data-value="4"
                    id="fourth"></i>
                  <i
                    class="fa fa-star {% if average_rating >= 5 %}checked{% else %}{% endif %}"
                    data-value="5"
                    id="fifth"></i>
                </div>
                <hr>
                {% if messages %}
                  <div class="d-flex justify-content-center">
                    <ul class="messages list-unstyled">
                      {% for message in messages %}
                        <li{% if message.tags %}
                          class="{{ message.tags }}"{% endif %}>{{ message }}</li>
                      {% endfor %}
                    </ul>
                  </div>
                {% endif %}
                <div class="d-flex justify-content-center">
                  <script
                    src='https://www.google.com/recaptcha/api.js'></script>
                  <div class="form-group g-recaptcha"
                       data-sitekey="6Lfh-30mAAAAAAcP00PLaQ8K0NTGy9B7MCW1_Hwq"></div>
                </div>
                <div class="d-flex justify-content-center">
                  <button type="submit" class="btn btn-primary">Добавить
                    рейтинг
                  </button>
                </div>
              </form>
              </div>
            {% else %}
              </div>
            {% endif %}
        <div class="">
          {% include 'includes/comments.html' %}
        </div>
        <div class="d-flex pb-4 justify-content-center">
          <button type="button" class="btn btn-primary btn-light">
            <a href="{% url 'structure:depart_detail' department_id %}">
              Назад
            </a>
          </button>
        </div>
      </div>
    </aside>
  </div>
{% endblock %}